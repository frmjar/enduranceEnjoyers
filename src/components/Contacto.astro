---
import Card from './Card.astro'

const { id, class: className } = Astro.props;
---

  <section id={id} class={`spacing-section ${className || ''}`}>
    <div class='container mx-auto spacing-container'>
      <div class='max-w-7xl mx-auto'>
        <div class='text-center mb-8 md:mb-12 lg:mb-16'>
          <h2 class='text-responsive-xl font-bold text-text-primary mb-4'>Contacto</h2>
          <p class='text-responsive-base text-text-secondary max-w-2xl mx-auto'>
            ¿Estás interesado en unirte a nosotros? ¡Nos encantaría saber de ti!
          </p>
        </div>

        <div class='grid grid-cols-1 xl:grid-cols-2 gap-6 lg:gap-8'>
          <div class='space-y-6'>
            <Card
              title='Redes Sociales'
              icon='calendar'
              iconColor='bg-cyan-500'
              titleInline
            >
              <p class='text-text-secondary mb-4'>
                Síguenos en nuestras redes sociales
              </p>
              <div class='flex items-center text-orange-400'>
                <a
                  href='https://x.com/EnduEnjoyers'
                  target='_blank'
                  aria-label='Twitter'
                  class='text-text-secondary hover:text-text-primary transition-colors'
                  rel='noreferrer'
                >
                  <span class='font-medium'>@EnduEnjoyers</span>
                </a>
              </div>
            </Card>

            <Card
              title='Requisitos'
              description='Para unirte al equipo necesitas:'
              icon='trophy'
              iconColor='bg-green-500'
              results={[
                'Cuenta de iRacing activa',
                'Discord para comunicación',
                'Pasión por las carreras'
              ]}
              titleInline
            />
          </div>

          <Card
            title='Formulario de Contacto'
            description='Completa el formulario y nos pondremos en contacto contigo'
            icon='calendar'
            iconColor='bg-blue-500'
            titleInline
          >
            <form class='space-y-4'>
              <div class='grid grid-cols-1 md:grid-cols-2 gap-4'>
                <div>
                  <label class='block text-sm font-medium text-text-secondary mb-2'>
                    Nombre en iRacing *
                </label>
                  <input
                    type='text'
                    name='iracingName'
                    placeholder='Tu nombre en iRacing'
                    class='w-full px-3 md:px-4 py-2 md:py-3 text-sm md:text-base bg-bg-input border border-border-medium rounded-lg text-text-primary placeholder-text-gray-light focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-all'
                    required
                  />
                </div>
                <div>
                  <label class='block text-sm font-medium text-text-secondary mb-2'>
                    ID de iRacing *
                </label>
                  <input
                    type='text'
                    name='iracingId'
                    placeholder='Tu ID de iRacing'
                    class='w-full px-4 py-3 bg-bg-input border border-border-medium rounded-lg text-text-primary placeholder-text-gray-light focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-all'
                    required
                  />
                </div>
              </div>

              <div class='grid grid-cols-1 md:grid-cols-2 gap-4'>
                <div>
                  <label class='block text-sm font-medium text-text-secondary mb-2'>
                    Discord *
                </label>
                  <input
                    type='text'
                    name='discord'
                    placeholder='Tu usuario de Discord'
                    class='w-full px-4 py-3 bg-bg-input border border-border-medium rounded-lg text-text-primary placeholder-text-gray-light focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-all'
                    required
                  />
                </div>
                <div>
                  <label class='block text-sm font-medium text-text-secondary mb-2'>
                    Email
                </label>
                  <input
                    type='email'
                    name='email'
                    placeholder='tu@email.com'
                    class='w-full px-4 py-3 bg-bg-input border border-border-medium rounded-lg text-text-primary placeholder-text-gray-light focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-all'
                  />
                </div>
              </div>

              <div>
                <label class='block text-sm font-medium text-text-secondary mb-2'>
                  iRacing y Safety *
                </label>
                <input
                  type='text'
                  name='iracingSafety'
                  placeholder='ej: 2000 iR A 4.0'
                  class='w-full px-4 py-3 bg-bg-input border border-border-medium rounded-lg text-text-primary placeholder-text-gray-light focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-all'
                  required
                />
              </div>

              <div>
                <label class='block text-sm font-medium text-text-secondary mb-3'>
                  ¿Tienes experiencia en iRacing? *
                </label>
                <div class='flex space-x-6'>
                  <label class='flex items-center'>
                    <input
                    type='radio'
                    name='experience'
                    value='si'
                    class='w-4 h-4 text-blue-400 bg-slate-500 border-slate-400 focus:ring-blue-400 focus:ring-2'
                    required
                  />
                    <span class='ml-2 text-text-secondary'>Sí</span>
                  </label>
                  <label class='flex items-center'>
                    <input
                    type='radio'
                    name='experience'
                    value='no'
                    class='w-4 h-4 text-blue-400 bg-slate-500 border-slate-400 focus:ring-blue-400 focus:ring-2'
                    required
                  />
                    <span class='ml-2 text-text-secondary'>No</span>
                  </label>
                </div>
              </div>

              <div>
                <label class='block text-sm font-medium text-text-secondary mb-2'>
                  ¿Quieres añadir algo más?
                </label>
                <textarea
                  rows='4'
                  name='additionalInfo'
                  placeholder='Cuéntanos más sobre ti...'
                  class='w-full px-4 py-3 bg-bg-input border border-border-medium rounded-lg text-text-primary placeholder-text-gray-light focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-all resize-none'
                />
              </div>

              <button
                type='submit'
                class='w-full bg-gradient-to-r from-orange-500 to-red-600 hover:from-orange-600 hover:to-red-700 text-white font-semibold py-2 md:py-3 px-4 md:px-6 text-sm md:text-base rounded-lg transition-all duration-300 transform hover:scale-[1.02] focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2 focus:ring-offset-tarjetas'
              >
                Enviar Solicitud
              </button>
            </form>
          </Card>
        </div>
      </div>
    </div>
  </section>

    <script>
document.addEventListener('DOMContentLoaded', () => {
  const form = document.querySelector('form')

  if (form) {
    form.addEventListener('submit', async (e) => {
      e.preventDefault()

      const formData = new FormData(form)

      try {
        const response = await fetch('/api/contacto', {
          method: 'POST',
          body: formData
        })
        const result = await response.json()

        if (result.success) {
          form.reset()
          alert('¡Solicitud enviada con éxito!')
        } else {
          throw new Error('Error en la respuesta del servidor')
        }
      } catch (error) {
        console.error('Error:', error)
        alert('Error al enviar la solicitud. Inténtalo de nuevo.')
      }
    })
  }
})
</script>
